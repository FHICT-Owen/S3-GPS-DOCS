@startuml C4_Elements
!include https://raw.githubusercontent.com/plantuml-stdlib/C4-PlantUML/master/C4_Container.puml

LAYOUT_WITH_LEGEND()

Person(brand, "Brand manager")
Person(customer, "Customer")
Person(staff, "Kitchen staff")
Person(manager, "Restaurant manager")

System_Ext(identity, "Identity service", "Provides authtentication with auth0.")

System_Boundary(boundry, "Restaurant-manager"){
	Container(spa, "Single-Page Application", "Vue + TypeScript", "Provides the menu and editing the menu + order-, inventory-, session- and table management.")

	Container(gateway, "Gateway service", "Spring MVC + Java", "Provides data to the front-end and controls authorization.")
	Container(discovery, "Discovery service", "Spring MVC + Java + Eureka", "Provides data to the front-end and controls authorization.")

	Container(menu_service, "Menu service", "Spring MVC + Java", "Retrieves the menu.")
	Container(session_service, "Session service", "Spring MVC + Java + Sqlite", "Retrieves the session and order data.")
	Container(inventory_service, "Inventory service", "Spring MVC + Java", "Retrieves the inventory data.")

	ContainerDb(menu_db, "Database", "PostgreSQL", "Stores the menu data.")
	ContainerDb(inventory_db, "Database", "PostgreSQL", "Stores the inventory data.")
}

Rel(customer, spa, "The customer uses the digital menu to order food.")
Rel(staff, spa, "label")
Rel(manager, spa, "Manages the menu and can add permissons to kitchen staff.")
Rel(manager, spa, "Manages the menu and can add permissons to kitchen staff.")
Rel(brand, spa, "Controls the white label of their restaurant cain.")

Rel(spa, gateway, "Uses websockets", "JSON/HTTPS, JSON/WSS")
Rel(spa, discovery, "Uses websockets", "JSON/HTTPS, JSON/WSS")

Rel(spa, identity, "Makes API calls to", "JSON/HTTPS")
Rel(gateway, identity, "Makes API calls to", "JSON/HTTPS")

Rel(discovery, gateway, "Uses websockets", "JSON/HTTPS, JSON/WSS")

Rel(gateway, menu_service, "Makes API calls to", "JSON/HTTPS")
Rel(gateway, session_service, "Makes API calls to", "JSON/HTTPS")
Rel(gateway, inventory_service, "Makes API calls to", "JSON/HTTPS")

Rel(menu_service, menu_db, "Retrieves menu data")
Rel(inventory_service, inventory_db, "Retrieves inventory data")

@enduml
