@startuml C4_Elements
!include https://raw.githubusercontent.com/plantuml-stdlib/C4-PlantUML/master/C4_Container.puml

LAYOUT_WITH_LEGEND()

Person(brand, "Brand manager")
Person(customer, "Customer")
Person(staff, "Kitchen staff")
Person(manager, "Restaurant manager")

System_Ext(identity, "Identity service", "Provides authtentication with auth0.")

System_Boundary(boundry, "Restaurant-manager"){
	Container(spa, "Single-Page Application", "Vue + TypeScript", "Provides the menu and editing the menu + order-, inventory-, session- and table management.")

	Container(discovery, "Discovery server", "Spring web + Java + Eureka", "Provides data to the front-end and controls authorization.")
	Container(gateway, "Gateway service", "Spring web + Java", "Provides data to the front-end and controls authorization.")

	Container(restaurant_service, "Restaurant service", "Spring web + Java", "Retrieves the restaurant, inventory and table data.")
	Container(menu_service, "Menu service", "Spring web + Java", "Retrieves the menu.")
	Container(session_service, "Session service", "Spring web + Java", "Retrieves the session and order data.")

	ContainerDb(restaurant_db, "Database", "PostgreSQL", "Stores the restaurant data.")
	ContainerDb(menu_db, "Database", "PostgreSQL", "Stores the menu data.")
	ContainerDb(session_db, "Database", "PostgreSQL", "Stores the inventory data.")
}

Rel(customer, spa, "The customer uses the digital menu to order food.")
Rel(staff, spa, "label")
Rel(manager, spa, "Manages the menu and can add permissons to kitchen staff.")
Rel(manager, spa, "Manages the menu and can add permissons to kitchen staff.")
Rel(brand, spa, "Controls the white label of their restaurant cain.")

Rel(spa, gateway, "Makes API calls to", "JSON/HTTPS, JSON/WSS")

Rel(spa, identity, "Makes API calls to", "JSON/HTTPS")
Rel(gateway, identity, "Makes API calls to", "JSON/HTTPS")

Rel(discovery, gateway, "Makes services discoverable", "JSON/HTTPS")

Rel(gateway, menu_service, "Makes API calls to", "JSON/HTTPS")
Rel(gateway, session_service, "Makes API calls to", "JSON/HTTPS")
Rel(gateway, restaurant_service, "Makes API calls to", "JSON/HTTPS")

Rel(restaurant_service, restaurant_db, "Retrieves restaurant data")
Rel(menu_service, menu_db, "Retrieves menu data")
Rel(session_service, session_db, "Retrieves session data")
@enduml
